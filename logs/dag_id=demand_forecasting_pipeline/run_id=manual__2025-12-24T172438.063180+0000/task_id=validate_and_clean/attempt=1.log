[2025-12-25T02:36:27.257+0900] {logging_mixin.py:188} INFO - Changing /mnt/d/My Apps/Airflow Demand Forecast Project/airflow-demand-forecasting/logs/dag_id=demand_forecasting_pipeline/run_id=manual__2025-12-24T17:24:38.063180+00:00/task_id=validate_and_clean permission to 509
[2025-12-25T02:36:27.323+0900] {logging_mixin.py:188} INFO - Changing /mnt/d/My Apps/Airflow Demand Forecast Project/airflow-demand-forecasting/logs/dag_id=demand_forecasting_pipeline/run_id=manual__2025-12-24T17:24:38.063180+00:00/task_id=validate_and_clean permission to 509
[2025-12-25T02:36:27.387+0900] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: demand_forecasting_pipeline.validate_and_clean manual__2025-12-24T17:24:38.063180+00:00 [queued]>
[2025-12-25T02:36:27.395+0900] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: demand_forecasting_pipeline.validate_and_clean manual__2025-12-24T17:24:38.063180+00:00 [queued]>
[2025-12-25T02:36:27.395+0900] {taskinstance.py:2170} INFO - Starting attempt 1 of 3
[2025-12-25T02:36:27.417+0900] {taskinstance.py:2191} INFO - Executing <Task(PythonOperator): validate_and_clean> on 2025-12-24 17:24:38.063180+00:00
[2025-12-25T02:36:27.421+0900] {standard_task_runner.py:60} INFO - Started process 16455 to run task
[2025-12-25T02:36:27.424+0900] {standard_task_runner.py:87} INFO - Running: ['airflow', 'tasks', 'run', 'demand_forecasting_pipeline', 'validate_and_clean', 'manual__2025-12-24T17:24:38.063180+00:00', '--job-id', '13', '--raw', '--subdir', 'DAGS_FOLDER/demand_forecasting_pipeline.py', '--cfg-path', '/tmp/tmpqhrzv8lb']
[2025-12-25T02:36:27.426+0900] {standard_task_runner.py:88} INFO - Job 13: Subtask validate_and_clean
[2025-12-25T02:36:27.475+0900] {logging_mixin.py:188} INFO - Changing /mnt/d/My Apps/Airflow Demand Forecast Project/airflow-demand-forecasting/logs/dag_id=demand_forecasting_pipeline/run_id=manual__2025-12-24T17:24:38.063180+00:00/task_id=validate_and_clean permission to 509
[2025-12-25T02:36:27.477+0900] {task_command.py:423} INFO - Running <TaskInstance: demand_forecasting_pipeline.validate_and_clean manual__2025-12-24T17:24:38.063180+00:00 [running]> on host LOQER.localdomain
[2025-12-25T02:36:27.554+0900] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='data-team' AIRFLOW_CTX_DAG_ID='demand_forecasting_pipeline' AIRFLOW_CTX_TASK_ID='validate_and_clean' AIRFLOW_CTX_EXECUTION_DATE='2025-12-24T17:24:38.063180+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-12-24T17:24:38.063180+00:00'
[2025-12-25T02:36:27.555+0900] {demand_forecasting_pipeline.py:118} INFO - Starting data validation and cleaning task
[2025-12-25T02:36:27.563+0900] {data_transformation.py:435} INFO - Starting data transformation: /mnt/d/My Apps/Airflow Demand Forecast Project/airflow-demand-forecasting/data/raw/sample_sales_data.csv -> /mnt/d/My Apps/Airflow Demand Forecast Project/airflow-demand-forecasting/data/processed/cleaned_data.csv
[2025-12-25T02:36:27.583+0900] {data_transformation.py:439} INFO - Loaded 1068 records from /mnt/d/My Apps/Airflow Demand Forecast Project/airflow-demand-forecasting/data/raw/sample_sales_data.csv
[2025-12-25T02:36:27.584+0900] {data_transformation.py:104} INFO - Starting data quality validation
[2025-12-25T02:36:27.585+0900] {data_transformation.py:118} INFO - ✓ Record count check passed: 1068 >= 90
[2025-12-25T02:36:27.588+0900] {data_transformation.py:142} INFO - ✓ Null rate check passed: 0.00% <= 5.00%
[2025-12-25T02:36:27.591+0900] {data_transformation.py:160} INFO - ✓ Negative sales check passed: 0 negative values
[2025-12-25T02:36:27.596+0900] {data_transformation.py:197} INFO - ✓ Date continuity check passed: max gap 1 <= 7 days
[2025-12-25T02:36:27.597+0900] {data_transformation.py:203} INFO - Data quality validation complete. Passed: 4/4 checks
[2025-12-25T02:36:27.597+0900] {data_transformation.py:281} INFO - Starting data cleaning. Original rows: 1068
[2025-12-25T02:36:27.602+0900] {data_transformation.py:314} INFO - Capped 41 outliers in sales_quantity to [19.5, 183.5]
[2025-12-25T02:36:27.604+0900] {data_transformation.py:342} INFO - Capped 44 outliers in revenue
[2025-12-25T02:36:27.611+0900] {data_transformation.py:390} INFO - Sorted data by ['date', 'product_id']
[2025-12-25T02:36:27.612+0900] {data_transformation.py:397} INFO - Data cleaning complete. Final rows: 1068 (removed 0)
[2025-12-25T02:36:27.624+0900] {data_transformation.py:451} INFO - Saved cleaned data to /mnt/d/My Apps/Airflow Demand Forecast Project/airflow-demand-forecasting/data/processed/cleaned_data.csv
[2025-12-25T02:36:27.624+0900] {demand_forecasting_pipeline.py:131} INFO - Validation: 4 checks passed, null rate: 0.0
[2025-12-25T02:36:27.625+0900] {python.py:201} INFO - Done. Returned value was: {'input_path': '/mnt/d/My Apps/Airflow Demand Forecast Project/airflow-demand-forecasting/data/raw/sample_sales_data.csv', 'output_path': '/mnt/d/My Apps/Airflow Demand Forecast Project/airflow-demand-forecasting/data/processed/cleaned_data.csv', 'validation': {'checks_performed': ['minimum_records', 'null_rate', 'no_negative_sales', 'date_continuity'], 'checks_passed': ['minimum_records', 'null_rate', 'no_negative_sales', 'date_continuity'], 'checks_failed': [], 'metrics': {'record_count': 1068, 'null_rates': {'date': 0.0, 'product_id': 0.0, 'sales_quantity': 0.0, 'revenue': 0.0}, 'overall_null_rate': 0.0, 'negative_sales_count': 0, 'max_date_gap_days': 1, 'num_unique_dates': 365}, 'validation_passed': True, 'validated_at': '2025-12-25T02:36:27.597027'}, 'cleaning': {'original_rows': 1068, 'operations': [{'type': 'outlier_capping', 'column': 'sales_quantity', 'count': 41}, {'type': 'outlier_capping', 'column': 'revenue', 'count': 44}, {'type': 'sort', 'columns': ['date', 'product_id']}], 'outlier_handling': {'sales_quantity': {'q1': 81.0, 'q3': 122.0, 'iqr': 41.0, 'lower_bound': 19.5, 'upper_bound': 183.5, 'outlier_count': 41, 'outlier_rate': 0.0384}, 'revenue': {'q1': 891.54, 'q3': 1374.75, 'iqr': 483.22, 'lower_bound': 166.71, 'upper_bound': 2099.58, 'outlier_count': 44, 'outlier_rate': 0.0412}}, 'null_handling': {'before': {'date': 0, 'product_id': 0, 'sales_quantity': 0, 'revenue': 0}, 'after': {'date': 0, 'product_id': 0, 'sales_quantity': 0, 'revenue': 0}}, 'final_rows': 1068, 'rows_removed': 0, 'cleaned_at': '2025-12-25T02:36:27.612337'}, 'processed_at': '2025-12-25T02:36:27.624616'}
[2025-12-25T02:36:27.646+0900] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=demand_forecasting_pipeline, task_id=validate_and_clean, execution_date=20251224T172438, start_date=20251224T173627, end_date=20251224T173627
[2025-12-25T02:36:27.677+0900] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-12-25T02:36:27.699+0900] {taskinstance.py:3280} INFO - 1 downstream tasks scheduled from follow-on schedule check
